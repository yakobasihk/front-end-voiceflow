const fs = require('fs');
const path = require('path');

module.exports = (rootDir = process.cwd(), workspace = 'packages') => {
  const packagesDir = path.join(rootDir, workspace);
  const packages = fs.readdirSync(packagesDir);

  return packages.map((pkg) => ({
    files: [`${workspace}/${pkg}/**/*`],
    extends: ['@voiceflow/eslint-config/typescript'],
    settings: {
      'import/resolver': {
        typescript: {
          project: path.join(packagesDir, pkg, 'tsconfig.json'),
        },
      },
    },
  }));
};
